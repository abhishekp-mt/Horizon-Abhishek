{% comment %}
  =============================
   Trust Badges / Info Strip
   - Supports multiple badges (icon + heading + subtext)
   - Customizable icon size, padding, and background
   - Horizontal scroll on mobile
  =============================
{% endcomment %}

<section
  class="trust-badges-strip"
  style="background-color: {{ section.settings.bg_color }}; padding: {{ section.settings.padding }}px 0;"
>
  <div class="page-width">
    <div class="trust-badges-strip__wrapper">
        <span class="prev btnns" style="display:none" ><</span>
      {% for block in section.blocks %}
        <div class="trust-badge-item">
          {% if block.settings.icon != blank %}
            <img
              src="{{ block.settings.icon | img_url: '100x' }}"
              alt="{{ block.settings.heading }}"
              style="width: {{ block.settings.icon_size }}px; height: auto;"
            >
          {% endif %}
          <div class="trust-badge-text">
            <h4>{{ block.settings.heading }}</h4>
            {% if block.settings.subtext != blank %}
              <p>{{ block.settings.subtext }}</p>
            {% endif %}
          </div>
        </div>
      {% endfor %}
      <span class="next btnns" style="display:none" >></span>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Trust Badges Strip",
  "settings": [
    {
      "type": "color",
      "id": "bg_color",
      "label": "Background color",
      "default": "#f5f5f5"
    },
    {
      "type": "range",
      "id": "padding",
      "label": "Section padding (top & bottom)",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 20
    },
    {
        "type":"number",
        "id":"seconds",
        "label" :"Scroll speed in ms ",
        "default" : 3000
    }
  ],
  "blocks": [
    {
      "type": "badge",
      "name": "Badge",
      "settings": [
        {
          "type": "image_picker",
          "id": "icon",
          "label": "Icon image"
        },
        {
          "type": "range",
          "id": "icon_size",
          "label": "Icon size (px)",
          "min": 20,
          "max": 100,
          "step": 5,
          "default": 30
        },
        {
          "type": "text",
          "id": "heading",
          "label": "Heading text",
          "default": "Free UK Delivery"
        },
        {
          "type": "text",
          "id": "subtext",
          "label": "Subtext",
          "default": "For orders over Â£29.99"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Trust Badges Strip",
      "category": "Custom"
    }
  ]
}
{% endschema %}

{% stylesheet %}
  .next{
    right:10px;
  }
  /* ============================
   Trust Badges Strip Styles
   ============================ */
  .trust-badges-strip {
    background-color: #f5f5f5;
    width: 100%;
  }

  .trust-badges-strip__wrapper {
    display: flex;
    align-items: center;
    justify-content: space-evenly;
    gap: 60px;
    flex-wrap: wrap;
    padding: 10px 0;
    scrollbar-width:none;
  }

  .trust-badge-item {
    display: flex;
    align-items: center;
    gap: 12px;
    text-align: left;
    flex-shrink: 0;
    transition: transform 0.3s ease;
  }

  .trust-badge-item img {
    display: block;
    max-width: 50px;
    height: auto;
  }

  .trust-badge-text h4 {
    font-weight: 600;
    color: #000;
    margin: 0;
  }

  .trust-badge-text p {
    font-size: 12px;
    color: #666;
    margin: 0;
  }

   /* @media (max-width:425px){ */
   
    .trust-badge-text h4 {
      font-size: 12px;
    }
    .trust-badge-text p {
        font-size: 9px;
    }
    
  /* } */

  

  /* Horizontal scroll on mobile */
  @media (max-width: 768px) {
    span.btnns {
        cursor:pointer;
        display:block !important;
    position: absolute;
    z-index: 999;
}


    .trust-badges-strip__wrapper {
      display: flex;
      flex-wrap: nowrap;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      scroll-snap-type: x mandatory;
      gap: 20px;
      justify-content: flex-start;
      padding: 10px 10px;
    }

    .trust-badge-item {
                width: 100%;
        justify-content: center;
      min-width: 200px;
      scroll-snap-align: start;
    }



    /* Hide scrollbar for mobile */
    .trust-badges-strip__wrapper::-webkit-scrollbar {
      display: none;
    }
  }
{% endstylesheet %}


<script>
document.addEventListener("DOMContentLoaded", function() {
  const wrapper = document.querySelector(".trust-badges-strip__wrapper");
  const prevBtn = document.querySelector(".prev");
  const nextBtn = document.querySelector(".next");
  const scrollAmount = 200;
  let autoScrollInterval;
  let autoScrollPaused = false;

  function updateButtons() {
    const maxScrollLeft = wrapper.scrollWidth - wrapper.clientWidth;
    prevBtn.style.display = wrapper.scrollLeft > 0 ? "block" : "none";
    nextBtn.style.display = wrapper.scrollLeft < maxScrollLeft ? "block" : "none";
  }

  function scrollNext() {
    const maxScrollLeft = wrapper.scrollWidth - wrapper.clientWidth;
    if (wrapper.scrollLeft >= maxScrollLeft) {
      wrapper.scrollTo({ left: 0, behavior: "smooth" });
    } else {
      wrapper.scrollBy({ left: scrollAmount, behavior: "smooth" });
    }
    setTimeout(updateButtons, 300);
  }

  function scrollPrev() {
    if (wrapper.scrollLeft <= 0) {
      wrapper.scrollTo({ left: wrapper.scrollWidth, behavior: "smooth" });
    } else {
      wrapper.scrollBy({ left: -scrollAmount, behavior: "smooth" });
    }
    setTimeout(updateButtons, 300);
  }

  // ---- Auto-scroll ----
  function startAutoScroll() {
    if (!autoScrollPaused) {
      autoScrollInterval = setInterval(scrollNext, {{section.settings.seconds}});
    }
  }

  function stopAutoScroll() {
    clearInterval(autoScrollInterval);
  }

  function restartAutoScroll() {
    stopAutoScroll();
    autoScrollPaused = true;
    setTimeout(() => {
      autoScrollPaused = false;
      startAutoScroll();
    }, 4000); // resume after 4s of inactivity
  }

  // ---- Manual Controls ----
  nextBtn.addEventListener("click", () => {
    scrollNext();
    restartAutoScroll();
  });

  prevBtn.addEventListener("click", () => {
    scrollPrev();
    restartAutoScroll();
  });

  // Pause on hover
  wrapper.addEventListener("mouseenter", stopAutoScroll);
  wrapper.addEventListener("mouseleave", startAutoScroll);

  wrapper.addEventListener("scroll", updateButtons);
  window.addEventListener("resize", updateButtons);

  updateButtons();
  startAutoScroll();
});
</script>

